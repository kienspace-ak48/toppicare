<div class="p-6">
  <div class="flex justify-between items-center mb-6">
    <div>
      <h1 class="text-2xl font-semibold">Gói dịch vụ</h1>
      <% if (service) { %>
  <p class="text-gray-500 text-sm">
    Thuộc dịch vụ: <b><%= service.name %></b>
  </p>
<% } else { %>
  <p class="text-red-500 text-sm">
    Không tìm thấy dịch vụ
  </p>
<% } %>

    </div>

    <a href="/admin/service-package/add/<%= service._id %>"
       class="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700">
      + Thêm gói
    </a>
  </div>

  <div class="bg-white shadow rounded overflow-x-auto">
    <table class="min-w-full text-sm text-left">
      <thead class="bg-gray-100">
        <tr>
          <th class="px-4 py-3">Tên gói</th>
          <th class="px-4 py-3">Giá</th>
          <th class="px-4 py-3">Thời hạn</th>
          <th class="px-4 py-3">Trạng thái</th>
          <th class="px-4 py-3 text-center">Hành động</th>
        </tr>
      </thead>
      <tbody>
        <% packages.forEach(p => { %>
          <tr class="border-t hover:bg-gray-50">
            <td class="px-4 py-3 font-medium"><%= p.name %></td>
            <td class="px-4 py-3"><%= p.price.toLocaleString() %>.000đ</td>
            <td class="px-4 py-3"><%= p.duration %></td>
            <td class="px-4 py-3">
              <span class="px-2 py-1 rounded text-xs
                <%= p.status ? "bg-green-100 text-green-700" : "bg-gray-200 text-gray-600" %>">
                <%= p.status ? "Hiển thị" : "Ẩn" %>
              </span>
            </td>
            <td class="px-4 py-3 text-center space-x-2">
              <a href="/admin/service-package/edit/<%= p._id %>"
                 class="text-blue-600 hover:underline">Sửa</a>

              <button onclick="deletePackage('<%= p._id %>')"
                      class="text-red-600 hover:underline">Xóa</button>
            </td>
          </tr>
        <% }) %>
      </tbody>
    </table>
  </div>
</div>

<script>
function deletePackage(id){
  if(!confirm("Xóa gói này?")) return;

  fetch(`/admin/service-package/delete/${id}`, { method: "DELETE" })
    .then(res => res.json())
    .then(res => {
      if(res.success) location.reload();
      else alert("Xóa thất bại");
    });
}
</script>
